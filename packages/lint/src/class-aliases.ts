export const CLASS_ALIASES: Record<string, string> = {
  abs: 'cdr-abstract',
  body: 'cdr-body',
  'body--s0': 'cdr-body--scale-0',
  'body--s1': 'cdr-body--scale-1',
  'body--str': 'cdr-body--strong',
  brow: 'cdr-eyebrow',
  btn: 'cdr-button',
  'btn--bg': 'cdr-button--with-background',
  'btn--dk': 'cdr-button--dark',
  'btn--fw': 'cdr-button--full-width',
  'btn--ico': 'cdr-button--icon-only',
  'btn--ico-l': 'cdr-button--has-icon-left',
  'btn--ico-lg': 'cdr-button--icon-only-large',
  'btn--ico-r': 'cdr-button--has-icon-right',
  'btn--lg': 'cdr-button--large',
  'btn--lnk': 'cdr-button--link',
  'btn--md': 'cdr-button--medium',
  'btn--pri': 'cdr-button--primary',
  'btn--sale': 'cdr-button--sale',
  'btn--sec': 'cdr-button--secondary',
  'btn--sm': 'cdr-button--small',
  cap: 'cdr-caption',
  cap__cite: 'cdr-caption__cite',
  cap__sum: 'cdr-caption__summary',
  cbx__box: 'cdr-checkbox__checkbox-box',
  cbx__svg: 'cdr-checkbox__svg-box',
  cont: 'cdr-container',
  'cont--stat': 'cdr-container--static',
  ferr: 'cdr-form-error',
  ferr__icon: 'cdr-form-error__icon',
  hdisp: 'cdr-heading-display',
  'hdisp--s2': 'cdr-heading-display--scale-2',
  'hdisp--s3': 'cdr-heading-display--scale-3',
  'hdisp--s4': 'cdr-heading-display--scale-4',
  'hdisp--s5': 'cdr-heading-display--scale-5',
  'hdisp--s6': 'cdr-heading-display--scale-6',
  'hdisp--s7': 'cdr-heading-display--scale-7',
  hsans: 'cdr-heading-sans',
  'hsans--s1': 'cdr-heading-sans--scale-1',
  'hsans--s2': 'cdr-heading-sans--scale-2',
  'hsans--s3': 'cdr-heading-sans--scale-3',
  hsb__head: 'cdr-heading-subheading-block__heading',
  hsb__sub: 'cdr-heading-subheading-block__subheading',
  hser: 'cdr-heading-serif',
  'hser--s1': 'cdr-heading-serif--scale-1',
  'hser--s2': 'cdr-heading-serif--scale-2',
  'hser--s3': 'cdr-heading-serif--scale-3',
  'hser--s4': 'cdr-heading-serif--scale-4',
  'hser--s5': 'cdr-heading-serif--scale-5',
  'hser--str': 'cdr-heading-serif--strong',
  icn: 'cdr-icon',
  'icn--ic': 'cdr-icon--inherit-color',
  'icn--lg': 'cdr-icon--large',
  'icn--md': 'cdr-icon--medium',
  'icn--sm': 'cdr-icon--small',
  img: 'cdr-image',
  'img--fit-con': 'cdr-image--fit-contain',
  'img--fit-cov': 'cdr-image--fit-cover',
  'img--fit-fil': 'cdr-image--fit-fill',
  'img--fit-none': 'cdr-image--fit-none',
  'img--fit-sd': 'cdr-image--fit-scale-down',
  'img--pos-b': 'cdr-image--position-bottom',
  'img--pos-c': 'cdr-image--position-center',
  'img--pos-l': 'cdr-image--position-left',
  'img--pos-r': 'cdr-image--position-right',
  'img--pos-t': 'cdr-image--position-top',
  'img--r16x9': 'cdr-image--ratio-16-9',
  'img--r1x1': 'cdr-image--ratio-1-1',
  'img--r1x2': 'cdr-image--ratio-1-2',
  'img--r2x1': 'cdr-image--ratio-2-1',
  'img--r3x4': 'cdr-image--ratio-3-4',
  'img--r4x3': 'cdr-image--ratio-4-3',
  'img--r9x16': 'cdr-image--ratio-9-16',
  'img--rad-rnd': 'cdr-image--radius-round',
  'img--rad-s': 'cdr-image--radius-soft',
  'img--rad-sh': 'cdr-image--radius-sharp',
  'img--rad-ss': 'cdr-image--radius-softer',
  inp: 'cdr-input',
  'inp--err': 'cdr-input--error',
  'inp--foc': 'cdr-input--focus',
  'inp--lg': 'cdr-input--large',
  'inp--ml': 'cdr-input--multiline',
  'inp--post': 'cdr-input--posticon',
  'inp--posts': 'cdr-input--posticons',
  'inp--pre': 'cdr-input--preicon',
  'inp--pri': 'cdr-input--primary',
  'inp--sec': 'cdr-input--secondary',
  'inp-wrap': 'cdr-input-wrap',
  inp__btn: 'cdr-input__button',
  inp__help: 'cdr-input__helper-text',
  inp__post: 'cdr-input__post-icon',
  inp__pre: 'cdr-input__pre-icon',
  'is-err': '--active-error',
  kick: 'cdr-kicker',
  lbls: 'cdr-label-standalone',
  lbls__helper: 'cdr-label-standalone__helper',
  lbls__info: 'cdr-label-standalone__info',
  'lbls__info-action': 'cdr-label-standalone__info-action',
  'lbls__input-spacing': 'cdr-label-standalone__input-spacing',
  'lbls__input-wrap': 'cdr-label-standalone__input-wrap',
  lbls__label: 'cdr-label-standalone__label',
  'lbls__label--dis': 'cdr-label-standalone__label--disabled',
  'lbls__label--sr': 'cdr-label-standalone__label--sr-only',
  'lbls__label-wrapper': 'cdr-label-standalone__label-wrapper',
  lbls__optional: 'cdr-label-standalone__optional',
  'lbls__post-content': 'cdr-label-standalone__post-content',
  lblw: 'cdr-label-wrapper',
  'lblw--dis': 'cdr-label-wrapper--disabled',
  'lblw--hfig': 'cdr-label-wrapper--hide-figure',
  'lblw--lg': 'cdr-label-wrapper--large',
  'lblw--md': 'cdr-label-wrapper--medium',
  'lblw--pri': 'cdr-label-wrapper--primary',
  'lblw--sec': 'cdr-label-wrapper--secondary',
  'lblw--sm': 'cdr-label-wrapper--small',
  lblw__cont: 'cdr-label-wrapper__container',
  lblw__content: 'cdr-label-wrapper__content',
  lblw__fig: 'cdr-label-wrapper__figure',
  lead: 'cdr-landing-lead',
  lead__copy: 'cdr-landing-lead__copy-block',
  lead__img: 'cdr-landing-lead__image',
  lnk: 'cdr-link',
  'lnk--ic': 'cdr-link--inherit-color',
  'lnk--neu': 'cdr-link--neutral',
  'lnk--solo': 'cdr-link--standalone',
  lst: 'cdr-list',
  'lst--cmp': 'cdr-list--compact',
  'lst--inl': 'cdr-list--inline',
  'lst--ord': 'cdr-list--ordered',
  'lst--unord': 'cdr-list--unordered',
  nprose: 'cdr-not-prose',
  prose: 'cdr-prose',
  'prose--inv': 'cdr-prose--invert',
  'prose--lg': 'cdr-prose--lg',
  'prose--meas': 'cdr-prose--measure',
  'prose--serif-h': 'cdr-prose--serif-headings',
  'prose--sm': 'cdr-prose--sm',
  qt: 'cdr-quote',
  'qt--pull': 'cdr-quote--pull',
  qt__cite: 'cdr-quote__citation',
  qt__sum: 'cdr-quote__summary',
  shsans: 'cdr-subheading-sans',
  'shsans--s-1': 'cdr-subheading-sans--scale-minus-1',
  'shsans--s0': 'cdr-subheading-sans--scale-0',
  'shsans--s1': 'cdr-subheading-sans--scale-1',
  'shsans--s2': 'cdr-subheading-sans--scale-2',
  split: 'cdr-split-surface',
  'split--bot': 'cdr-split-surface--bottom',
  'split--top': 'cdr-split-surface--top',
  split__bot: 'cdr-split-surface__bottom',
  split__top: 'cdr-split-surface__top',
  ttl: 'cdr-title',
  txt: 'cdr-text',
  usans: 'cdr-utility-sans',
  'usans--s-1': 'cdr-utility-sans--scale-minus-1',
  'usans--s0': 'cdr-utility-sans--scale-0',
  'usans--s1': 'cdr-utility-sans--scale-1',
  'usans--s2': 'cdr-utility-sans--scale-2',
  'usans--s3': 'cdr-utility-sans--scale-3',
  'usans--str': 'cdr-utility-sans--strong',
  userf: 'cdr-utility-serif',
  'userf--s-1': 'cdr-utility-serif--scale-minus-1',
  'userf--s0': 'cdr-utility-serif--scale-0',
  'userf--s1': 'cdr-utility-serif--scale-1',
  'userf--s2': 'cdr-utility-serif--scale-2',
  'userf--s3': 'cdr-utility-serif--scale-3',
  'userf--str': 'cdr-utility-serif--strong',
};

const BASE_CLASS_ALIASES = Object.fromEntries(
  Object.entries(CLASS_ALIASES).filter(
    ([alias, canonical]) =>
      !alias.includes('--') &&
      !alias.includes('__') &&
      !canonical.includes('--') &&
      !canonical.includes('__'),
  ),
);

const BASE_CLASS_ALIASES_BY_CANONICAL = Object.entries(
  BASE_CLASS_ALIASES,
).reduce<Record<string, string[]>>((acc, [alias, canonical]) => {
  if (!acc[canonical]) {
    acc[canonical] = [];
  }
  acc[canonical].push(alias);
  return acc;
}, {});

export const getBaseClassAliases = (baseClass: string): string[] =>
  BASE_CLASS_ALIASES_BY_CANONICAL[baseClass] ?? [];

const resolveBaseAlias = (className: string): string => {
  const direct = CLASS_ALIASES[className];
  if (direct) {
    return direct;
  }

  const modifierIndex = className.indexOf('--');
  if (modifierIndex > 0) {
    const base = className.slice(0, modifierIndex);
    const rest = className.slice(modifierIndex + 2);
    const resolvedBase = BASE_CLASS_ALIASES[base];
    if (resolvedBase) {
      return `${resolvedBase}--${rest}`;
    }
  }

  const elementIndex = className.indexOf('__');
  if (elementIndex > 0) {
    const base = className.slice(0, elementIndex);
    const rest = className.slice(elementIndex + 2);
    const resolvedBase = BASE_CLASS_ALIASES[base];
    if (resolvedBase) {
      return `${resolvedBase}__${rest}`;
    }
  }

  return className;
};

export const resolveClassAlias = (className: string): string => {
  if (!className.includes('@')) {
    return resolveBaseAlias(className);
  }

  const [base, suffix] = className.split('@');
  const resolvedBase = resolveBaseAlias(base);
  if (resolvedBase === base) {
    return className;
  }
  return `${resolvedBase}@${suffix}`;
};
